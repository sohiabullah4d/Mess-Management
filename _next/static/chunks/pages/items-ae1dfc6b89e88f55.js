(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[380],{1767:(e,t,a)=>{"use strict";a.d(t,{GF:()=>i,J8:()=>s,P2:()=>l,Yq:()=>n});let n=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),s=(e,t)=>e.filter(e=>(!t.name||!!e.name.toLowerCase().includes(t.name.toLowerCase()))&&(!t.status||e.status===t.status)&&(!t.unit||e.unit===t.unit)),l=(e,t,a,n,s)=>{let l=new Date(n,s-1,1),i=new Date(n,s,0),r=e.filter(e=>{let t=new Date(e.date);return t>=l&&t<=i}),o=r.length,d={};r.forEach(e=>{e.itemsUsed.forEach(e=>{d[e.itemId]||(d[e.itemId]=0),d[e.itemId]+=e.totalUsed})});let c=t.map(e=>{let t=d[e.id]||0,a=e.quantity-t;return{...e,used:t,remaining:a,needsRestocking:a<.2*e.quantity}}).filter(e=>e.needsRestocking),u=Object.entries(d).map(e=>{let[a,n]=e,s=t.find(e=>e.id===a);return{name:(null==s?void 0:s.name)||"Unknown",totalUsed:n,unit:(null==s?void 0:s.unit)||""}}).sort((e,t)=>t.totalUsed-e.totalUsed).slice(0,5);return{mealsPrepared:o,itemUsage:d,itemsNeedRestocking:c,mostUsedItems:u}},i=(e,t)=>{let a=Object.keys(e[0]||{}).join(","),n=e.map(e=>Object.values(e).map(e=>"string"==typeof e&&e.includes(",")?'"'.concat(e,'"'):e).join(",")).join("\n"),s=new Blob(["".concat(a,"\n").concat(n)],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),i=URL.createObjectURL(s);l.setAttribute("href",i),l.setAttribute("download","".concat(t,".csv")),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)}},4432:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/items",function(){return a(4604)}])},4604:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var n=a(5640),s=a(223),l=a(904),i=a(5482),r=a(4327),o=a(8795),d=a(3097),c=a(2738),u=a(6624),m=a(5057),h=a(1585),x=a(4447),j=a(3857),A=a(9246),g=a(2714),b=a(7498),v=a(6393),p=a(148),y=a(331),f=a(1957);let w=f.Ik({name:f.Yj().required("Item name is required"),quantity:f.ai().min(0,"Quantity must be at least 0").required("Quantity is required"),unit:f.Yj().required("Unit is required"),notes:f.Yj()});var C=a(5906);let N=["kg","litre","piece","pack","dozen","bottle","can"],S=e=>{let{item:t,onSubmit:a}=e,{state:s}=(0,C.U)(),[l,i]=(0,p.useState)([]);(0,p.useEffect)(()=>{i(s.items.map(e=>e.name.toLowerCase()))},[s.items]);let r=(0,y.Wx)({initialValues:{name:(null==t?void 0:t.name)||"",quantity:(null==t?void 0:t.quantity)||0,unit:(null==t?void 0:t.unit)||"",notes:(null==t?void 0:t.notes)||""},validationSchema:w,onSubmit:e=>{if(l.some(a=>a===e.name.toLowerCase()&&(!t||t.name.toLowerCase()!==e.name.toLowerCase())))return void r.setFieldError("name","Item with this name already exists");a(e)}});return(0,n.jsx)("form",{id:"item-form",onSubmit:r.handleSubmit,children:(0,n.jsxs)(x.Ay,{container:!0,spacing:2,children:[(0,n.jsx)(x.Ay,{item:!0,xs:12,children:(0,n.jsx)(j.A,{fullWidth:!0,id:"name",name:"name",label:"Item Name",value:r.values.name,onChange:r.handleChange,error:r.touched.name&&!!r.errors.name,helperText:r.touched.name&&r.errors.name})}),(0,n.jsx)(x.Ay,{item:!0,xs:6,children:(0,n.jsx)(j.A,{fullWidth:!0,id:"quantity",name:"quantity",label:"Quantity",type:"number",value:r.values.quantity,onChange:r.handleChange,error:r.touched.quantity&&!!r.errors.quantity,helperText:r.touched.quantity&&r.errors.quantity,inputProps:{min:0,step:.01}})}),(0,n.jsx)(x.Ay,{item:!0,xs:6,children:(0,n.jsxs)(A.A,{fullWidth:!0,error:r.touched.unit&&!!r.errors.unit,children:[(0,n.jsx)(g.A,{id:"unit-label",children:"Unit"}),(0,n.jsx)(b.A,{labelId:"unit-label",id:"unit",name:"unit",value:r.values.unit,onChange:r.handleChange,onBlur:r.handleBlur,label:"Unit",children:N.map(e=>(0,n.jsx)(v.A,{value:e,children:e},e))})]})}),(0,n.jsx)(x.Ay,{item:!0,xs:12,children:(0,n.jsx)(j.A,{fullWidth:!0,id:"notes",name:"notes",label:"Notes",multiline:!0,rows:3,value:r.values.notes,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.notes&&!!r.errors.notes,helperText:r.touched.notes&&r.errors.notes})})]})})};var k=a(6105),q=a(8894),U=a(1767);let I=()=>{let{state:e,addItem:t,updateItem:a,deleteItem:y}=(0,C.U)(),[f,w]=(0,p.useState)(!1),[N,I]=(0,p.useState)(),[P,E]=(0,p.useState)({name:"",status:"",unit:""}),[_,W]=(0,p.useState)(0),[L,D]=(0,p.useState)(10),[O,z]=(0,p.useState)("createdAt"),[R,B]=(0,p.useState)("desc"),Y=(0,U.J8)(e.items,P),Q=[...Y].sort((e,t)=>{let a=e[O],n=t[O];return null==a||null==n?0:a<n?"asc"===R?-1:1:a>n?"asc"===R?1:-1:0}).slice(_*L,_*L+L),T=[{id:"name",label:"Name",sortable:!0},{id:"quantity",label:"Quantity",sortable:!0,align:"right"},{id:"unit",label:"Unit",sortable:!0},{id:"status",label:"Status",sortable:!0,format:e=>(0,n.jsx)(o.A,{label:(null==e?void 0:e.toString())||"",color:"in-stock"===e?"success":"error",size:"small",className:"capitalize"})},{id:"createdAt",label:"Created Date",sortable:!0,format:e=>"string"==typeof e?(0,U.Yq)(e):""},{id:"notes",label:"Notes",sortable:!1},{id:"actions",label:"Actions",sortable:!1,align:"center",format:(e,t)=>(0,n.jsxs)(d.A,{className:"flex space-x-1",children:[(0,n.jsx)(c.A,{size:"small",onClick:()=>{I(t),w(!0)},className:"text-blue-500 hover:bg-blue-50",children:(0,n.jsx)(s.A,{})}),(0,n.jsx)(c.A,{size:"small",onClick:()=>{var e;return e=t.id,void(window.confirm("Are you sure you want to delete this item?")&&y(e))},className:"text-red-500 hover:bg-red-50",children:(0,n.jsx)(l.A,{})})]})}];return(0,n.jsxs)(d.A,{className:"p-4",children:[(0,n.jsxs)(d.A,{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[(0,n.jsx)(u.A,{variant:"h4",className:"font-bold text-gray-800 ",children:"Items Management"}),(0,n.jsxs)(d.A,{className:"flex flex-col sm:flex-row gap-2",children:[(0,n.jsx)(m.A,{variant:"outlined",onClick:()=>{let t=e.items.map(e=>({Name:e.name,Quantity:e.quantity,Unit:e.unit,Status:e.status,"Created Date":(0,U.Yq)(e.createdAt),Notes:e.notes||""}));(0,U.GF)(t,"items-export")},className:"border-primary-500 text-primary-500 hover:bg-primary-50",children:"Export CSV"}),(0,n.jsx)(m.A,{variant:"contained",startIcon:(0,n.jsx)(i.A,{}),onClick:()=>w(!0),className:"bg-primary-500 hover:bg-primary-600",children:"Add Item"})]})]}),(0,n.jsx)(h.A,{className:"p-4 mb-6 bg-white  shadow-sm rounded-lg",children:(0,n.jsxs)(x.Ay,{container:!0,spacing:2,children:[(0,n.jsx)(x.Ay,{item:!0,xs:12,sm:4,children:(0,n.jsx)(j.A,{fullWidth:!0,label:"Search by name",value:P.name,onChange:e=>E({...P,name:e.target.value}),InputProps:{startAdornment:(0,n.jsx)(r.A,{className:"mr-2 text-gray-400"})},className:"bg-white "})}),(0,n.jsx)(x.Ay,{item:!0,xs:12,sm:4,children:(0,n.jsxs)(A.A,{fullWidth:!0,children:[(0,n.jsx)(g.A,{children:"Status"}),(0,n.jsxs)(b.A,{value:P.status,label:"Status",onChange:e=>E({...P,status:e.target.value}),className:"bg-white ",children:[(0,n.jsx)(v.A,{value:"",children:"All"}),(0,n.jsx)(v.A,{value:"in-stock",children:"In Stock"}),(0,n.jsx)(v.A,{value:"out-of-stock",children:"Out of Stock"})]})]})}),(0,n.jsx)(x.Ay,{item:!0,xs:12,sm:4,children:(0,n.jsxs)(A.A,{fullWidth:!0,children:[(0,n.jsx)(g.A,{children:"Unit"}),(0,n.jsxs)(b.A,{value:P.unit,label:"Unit",onChange:e=>E({...P,unit:e.target.value}),className:"bg-white ",children:[(0,n.jsx)(v.A,{value:"",children:"All"}),(0,n.jsx)(v.A,{value:"kg",children:"kg"}),(0,n.jsx)(v.A,{value:"litre",children:"litre"}),(0,n.jsx)(v.A,{value:"piece",children:"piece"}),(0,n.jsx)(v.A,{value:"pack",children:"pack"}),(0,n.jsx)(v.A,{value:"dozen",children:"dozen"}),(0,n.jsx)(v.A,{value:"bottle",children:"bottle"}),(0,n.jsx)(v.A,{value:"can",children:"can"})]})]})})]})}),(0,n.jsx)(q.X,{columns:T,data:Q,page:_,rowsPerPage:L,totalRows:Y.length,onPageChange:W,onRowsPerPageChange:D,orderBy:O,order:R,onSort:e=>{B(O===e&&"asc"===R?"desc":"asc"),z(e)}}),(0,n.jsx)(k.a,{open:f,onClose:()=>{w(!1),I(void 0)},title:N?"Edit Item":"Add New Item",actions:(0,n.jsxs)(d.A,{sx:{display:"flex",gap:2},children:[(0,n.jsx)(m.A,{onClick:()=>{w(!1),I(void 0)},variant:"outlined",className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,n.jsxs)(m.A,{type:"submit",form:"item-form",variant:"contained",className:"bg-primary-500 hover:bg-primary-600",children:[N?"Update":"Add"," Item"]})]}),children:(0,n.jsx)(S,{item:N,onSubmit:e=>{N?a({...N,...e}):t(e),w(!1),I(void 0)},onCancel:()=>{w(!1),I(void 0)}})})]})}},6105:(e,t,a)=>{"use strict";a.d(t,{a:()=>c});var n=a(5640);a(148);var s=a(5704),l=a(2375),i=a(2738),r=a(7021),o=a(2711),d=a(7630);let c=e=>{let{open:t,onClose:a,title:c,children:u,actions:m}=e;return(0,n.jsxs)(s.A,{open:t,onClose:a,maxWidth:"md",fullWidth:!0,children:[(0,n.jsxs)(l.A,{children:[c,(0,n.jsx)(i.A,{"aria-label":"close",onClick:a,sx:{position:"absolute",right:8,top:8},children:(0,n.jsx)(d.A,{})})]}),(0,n.jsx)(r.A,{children:u}),m&&(0,n.jsx)(o.A,{children:m})]})}},8894:(e,t,a)=>{"use strict";a.d(t,{X:()=>h});var n=a(5640);a(148);var s=a(1585),l=a(2254),i=a(9015),r=a(9366),o=a(8488),d=a(3245),c=a(3671),u=a(8932),m=a(5504);let h=e=>{let{columns:t,data:a,page:h,rowsPerPage:x,totalRows:j,onPageChange:A,onRowsPerPageChange:g,orderBy:b,order:v,onSort:p}=e;return(0,n.jsxs)(s.A,{children:[(0,n.jsx)(l.A,{children:(0,n.jsxs)(i.A,{children:[(0,n.jsx)(r.A,{children:(0,n.jsx)(o.A,{children:t.map(e=>{let t;return(0,n.jsx)(d.A,{align:e.align||"left",sortDirection:b===e.id&&v,children:e.sortable&&p?(0,n.jsx)(c.A,{active:b===e.id,direction:b===e.id?v:"asc",onClick:(t=String(e.id),()=>{null==p||p(t)}),children:e.label}):e.label},String(e.id))})})}),(0,n.jsx)(u.A,{children:a.map((e,a)=>(0,n.jsx)(o.A,{children:t.map(t=>{let a=e[t.id];return(0,n.jsx)(d.A,{align:t.align||"left",children:t.format?t.format(a,e):String(null!=a?a:"")},String(t.id))})},a))})]})}),(0,n.jsx)(m.A,{rowsPerPageOptions:[5,10,25],component:"div",count:j,rowsPerPage:x,page:h,onPageChange:(e,t)=>{A(t)},onRowsPerPageChange:e=>{g(parseInt(e.target.value,10))}})]})}}},e=>{e.O(0,[447,269,130,892,636,593,792],()=>e(e.s=4432)),_N_E=e.O()}]);